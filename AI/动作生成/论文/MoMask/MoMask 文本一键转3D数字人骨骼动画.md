# MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”»



![å›¾ç‰‡](https://image.jiqizhixin.com/uploads/editor/67b517f5-16d2-43ed-bdd8-d4f92b9c7678/640.png)

- è®ºæ–‡é¢˜ç›®ï¼šMoMask: Generative Masked Modeling of 3D Human Motions
- è®ºæ–‡é“¾æ¥ï¼šhttps://arxiv.org/abs/2312.00063
- ä»£ç é“¾æ¥ï¼šhttps://github.com/EricGuo5513/momask-codes
- Huggingface Space é“¾æ¥ï¼šhttps://huggingface.co/spaces/MeYourHint/MoMask
- ä¸»é¡µï¼šhttps://ericguo5513.github.io/momask/

è®²è§£ï¼š**https://www.jiqizhixin.com/articles/2024-04-29-3**

æ²¡æœ‰æ‰‹æŒ‡ï¼Œè¿˜æ˜¯ä¼šæœ‰æŠ–åŠ¨

![image-20240715104041805](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240715104041805.png)



### å‰ç½®çŸ¥è¯†

#### VQ-VAE

https://blog.csdn.net/DeepViewInsight/article/details/133103810

VQ-VAE:Neural discrete representation learning[1711.00937]

ã€[è®ºæ–‡ç®€æ]VQ-VAE:Neural discrete representation learning[1711.00937]ã€‘ https://www.bilibili.com/video/BV1bb4y1i7j6/?share_source=copy_web&vd_source=2c8847c41a6c97560a277330511f1edd

https://sunlin-ai.github.io/2022/06/02/VQ-VAE.html



åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ é¢†åŸŸï¼Œè‡ªåŠ¨ç¼–ç å™¨ï¼ˆAutoencoderï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ç¥ç»ç½‘ç»œæ¶æ„ï¼Œç”¨äºé™ç»´ã€ç‰¹å¾å­¦ä¹ å’Œç”Ÿæˆæ•°æ®ç­‰ä»»åŠ¡ã€‚Variational Quantized Variational Autoencoderï¼ˆVQ-VAEï¼‰æ˜¯è‡ªåŠ¨ç¼–ç å™¨çš„ä¸€ç§æ‰©å±•ï¼Œå®ƒç»“åˆäº†å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼ˆVariational Autoencoderï¼‰å’Œé‡åŒ–æ–¹æ³•ï¼ˆQuantizationï¼‰ï¼Œå¹¶åœ¨å›¾åƒå’ŒéŸ³é¢‘ç”Ÿæˆç­‰é¢†åŸŸå–å¾—äº†æ˜¾è‘—çš„æˆåŠŸã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨VQ-VAEçš„å·¥ä½œåŸç†ï¼Œè§£é‡Šå®ƒçš„åº”ç”¨å’Œä¼˜åŠ¿ï¼Œå¹¶æä¾›ä»£ç ç¤ºä¾‹æ¥å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£ã€‚

**ä»€ä¹ˆæ˜¯ VQ-VAEï¼Ÿ**
VQ-VAEä»£è¡¨"Variational Quantized Variational Autoencoder"ï¼Œæ˜¯ä¸€ç§ç”Ÿæˆæ¨¡å‹ï¼Œé€šå¸¸ç”¨äºå¤„ç†é«˜ç»´æ•°æ®ï¼Œå¦‚å›¾åƒå’ŒéŸ³é¢‘ã€‚å®ƒçš„è®¾è®¡çµæ„Ÿæ¥è‡ªäºå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼ˆVAEï¼‰å’Œé‡åŒ–æ–¹æ³•ï¼Œç»“åˆäº†å®ƒä»¬çš„ä¼˜ç‚¹ï¼Œä½¿å¾— VQ-VAE èƒ½å¤Ÿç”Ÿæˆé«˜è´¨é‡çš„æ•°æ®ï¼Œå¹¶åœ¨æ•°æ®è¡¨ç¤ºä¸Šå¼•å…¥ç¦»æ•£æ€§ã€‚

**å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼ˆVariational Autoencoderï¼‰**
å˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼ˆVariational Autoencoderï¼Œç®€ç§° VAEï¼‰æ˜¯ä¸€ç§ç”Ÿæˆæ¨¡å‹ï¼Œå®ƒé€šè¿‡å­¦ä¹ æ•°æ®çš„æ½œåœ¨åˆ†å¸ƒæ¥ç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬ã€‚VAEçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®ç¼–ç æˆæ½œåœ¨ç©ºé—´ä¸­çš„åˆ†å¸ƒï¼Œå¹¶ä»è¯¥åˆ†å¸ƒä¸­é‡‡æ ·ä»¥ç”Ÿæˆæ–°çš„æ ·æœ¬ã€‚è¿™ä½¿å¾— VAE èƒ½å¤Ÿåœ¨ç”Ÿæˆæ–°æ•°æ®æ—¶å…·æœ‰ä¸€å®šçš„éšæœºæ€§ï¼Œå› æ­¤éå¸¸é€‚åˆç”Ÿæˆä»»åŠ¡ã€‚

![image-20240724101920121](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240724101920121.png)

**é‡åŒ–æ–¹æ³•ï¼ˆQuantizationï¼‰**
é‡åŒ–æ–¹æ³•æ˜¯ä¸€ç§å°†è¿ç»­æ•°æ®æ˜ å°„åˆ°ç¦»æ•£æ•°æ®çš„æŠ€æœ¯ã€‚åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ K-means ç­‰èšç±»ç®—æ³•æ¥æ‰§è¡Œé‡åŒ–ã€‚é€šè¿‡å¼•å…¥ç¦»æ•£æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘æ•°æ®è¡¨ç¤ºçš„å¤æ‚æ€§ï¼Œä»è€Œé™ä½æ¨¡å‹çš„è®¡ç®—å’Œå­˜å‚¨æˆæœ¬ã€‚

**VQ-VAE çš„å·¥ä½œåŸç†**
ä¸ºäº†æ›´å¥½åœ°ç†è§£ VQ-VAEï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„å·¥ä½œåŸç†ã€‚

**ç¼–ç å™¨ï¼ˆEncoderï¼‰**
VQ-VAE çš„ç¼–ç å™¨éƒ¨åˆ†å°†è¾“å…¥æ•°æ®ç¼–ç æˆæ½œåœ¨è¡¨ç¤ºã€‚è¿™ä¸æ ‡å‡†çš„è‡ªåŠ¨ç¼–ç å™¨ç±»ä¼¼ï¼Œä½†ç¼–ç å™¨çš„è¾“å‡ºä¸æ˜¯ç›´æ¥çš„æ½œåœ¨å‘é‡ï¼Œè€Œæ˜¯ä¸€ä¸ª**è¡¨ç¤ºç¬¦å·ï¼ˆcodebook indexï¼‰**ã€‚ç¼–ç å™¨çš„ä»»åŠ¡æ˜¯æ‰¾åˆ°**æœ€æ¥è¿‘è¾“å…¥çš„è¡¨ç¤ºç¬¦å·**ï¼Œå³æœ€æ¥è¿‘çš„èšç±»ä¸­å¿ƒã€‚

**é‡åŒ–å™¨ï¼ˆQuantizerï¼‰**
é‡åŒ–å™¨æ¥å—ç¼–ç å™¨çš„è¾“å‡ºï¼Œå°†å…¶**æ˜ å°„åˆ°ç¦»æ•£**è¡¨ç¤ºã€‚è¿™æ˜¯é€šè¿‡**æŸ¥æ‰¾æœ€æ¥è¿‘çš„èšç±»ä¸­å¿ƒ**æ¥å®Œæˆçš„ï¼Œç„¶å**è¾“å‡ºè¯¥èšç±»ä¸­å¿ƒçš„ç´¢å¼•**ã€‚è¿™ä¸ªæ­¥éª¤å¼•å…¥äº†ç¦»æ•£æ€§ï¼Œå‡å°äº†è¡¨ç¤ºçš„ç»´åº¦ï¼Œé™ä½äº†å¤æ‚æ€§ã€‚

**è§£ç å™¨ï¼ˆDecoderï¼‰**
è§£ç å™¨éƒ¨åˆ†æ¥å—æ¥è‡ªé‡åŒ–å™¨çš„ç¦»æ•£è¡¨ç¤ºï¼Œå¹¶å°è¯•ç”Ÿæˆä¸åŸå§‹è¾“å…¥ç›¸åŒ¹é…çš„æ•°æ®ã€‚è¿™ä¸€è¿‡ç¨‹ä¸æ ‡å‡†è‡ªåŠ¨ç¼–ç å™¨çš„è§£ç å™¨ç±»ä¼¼ï¼Œä½†åœ¨ VQ-VAE ä¸­ï¼Œè§£ç å™¨çš„ä»»åŠ¡æ›´åŠ å›°éš¾ï¼Œå› ä¸ºå®ƒå¿…é¡»**å°†ç¦»æ•£è¡¨ç¤ºæ˜ å°„å›è¿ç»­æ•°æ®**ã€‚

**æŸå¤±å‡½æ•°**
VQ-VAE ä½¿ç”¨äº†å¤šä¸ªæŸå¤±å‡½æ•°æ¥è®­ç»ƒæ¨¡å‹ï¼Œå…¶ä¸­åŒ…æ‹¬é‡å»ºæŸå¤±ï¼ˆreconstruction lossï¼‰å’Œæ½œåœ¨æŸå¤±ï¼ˆcodebook lossï¼‰ã€‚é‡å»ºæŸå¤±ç”¨äºç¡®ä¿è§£ç å™¨èƒ½å¤Ÿç”Ÿæˆæ¥è¿‘åŸå§‹è¾“å…¥çš„æ•°æ®ï¼Œè€Œæ½œåœ¨æŸå¤±åˆ™ç”¨äºæ¨åŠ¨ç¼–ç å™¨ç”Ÿæˆæœ‰æ•ˆçš„æ½œåœ¨è¡¨ç¤ºã€‚

**VQ-VAE çš„åº”ç”¨**

VQ-VAE åœ¨å›¾åƒå’ŒéŸ³é¢‘ç”Ÿæˆã€æ•°æ®å‹ç¼©å’Œç”Ÿæˆæ€§å¯¹æŠ—ç½‘ç»œï¼ˆGANsï¼‰ç­‰é¢†åŸŸå…·æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š

**å›¾åƒç”Ÿæˆ**
VQ-VAE å¯ä»¥ç”¨äºç”Ÿæˆé«˜è´¨é‡çš„å›¾åƒï¼ŒåŒ…æ‹¬äººè„¸å›¾åƒã€è‡ªç„¶åœºæ™¯å’Œè‰ºæœ¯ä½œå“ã€‚ç”±äºå…¶ç¦»æ•£è¡¨ç¤ºçš„ç‰¹æ€§ï¼Œå®ƒå¯ä»¥ç”Ÿæˆæ¸…æ™°å’Œå¤šæ ·çš„å›¾åƒã€‚

**éŸ³é¢‘ç”Ÿæˆ**
VQ-VAE ä¹Ÿå¯ä»¥ç”¨äºç”ŸæˆéŸ³é¢‘ï¼Œä¾‹å¦‚è¯­éŸ³åˆæˆæˆ–éŸ³ä¹ç”Ÿæˆã€‚å®ƒå¯ä»¥æ•æ‰éŸ³é¢‘çš„æ—¶é—´ç»“æ„å’Œé¢‘è°±ç‰¹å¾ï¼Œç”Ÿæˆé€¼çœŸçš„å£°éŸ³ã€‚

**æ•°æ®å‹ç¼©**
ç”±äº VQ-VAE å¼•å…¥äº†ç¦»æ•£æ€§ï¼Œå®ƒå¯ä»¥ç”¨äºæ•°æ®å‹ç¼©ã€‚è¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨æ›´å°‘çš„ä½æ•°æ¥è¡¨ç¤ºæ•°æ®ï¼Œä»è€Œå‡å°‘å­˜å‚¨å’Œä¼ è¾“æˆæœ¬ã€‚

**ç”Ÿæˆæ€§å¯¹æŠ—ç½‘ç»œï¼ˆGANsï¼‰**
VQ-VAE å¯ä»¥ä¸ç”Ÿæˆæ€§å¯¹æŠ—ç½‘ç»œï¼ˆGANsï¼‰ç»“åˆä½¿ç”¨ï¼Œä»¥ç”Ÿæˆæ›´é€¼çœŸçš„å›¾åƒå’ŒéŸ³é¢‘ã€‚é€šè¿‡å°† VQ-VAE ä½œä¸º GANs çš„ç”Ÿæˆå™¨ï¼Œå¯ä»¥è·å¾—æ›´å¥½çš„ç”Ÿæˆæ•ˆæœã€‚
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/DeepViewInsight/article/details/133103810

![image-20240724104038729](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240724104038729.png)

VQ-VAE é€šè¿‡å‘ç½‘ç»œæ·»åŠ ç¦»æ•£çš„ **codebook** ç»„ä»¶æ¥æ‰©å±•æ ‡å‡†è‡ªç¼–ç å™¨ã€‚codebook æ˜¯ä¸ç›¸åº”ç´¢å¼•å…³è”çš„å‘é‡åˆ—è¡¨ã€‚å®ƒç”¨äºé‡åŒ–è‡ªç¼–ç å™¨çš„ç“¶é¢ˆï¼›å°†ç¼–ç å™¨ç½‘ç»œçš„è¾“å‡ºä¸ codebook çš„æ‰€æœ‰å‘é‡è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å°†æ¬§æ°è·ç¦»æœ€æ¥è¿‘çš„ codebook å‘é‡å–‚ç»™è§£ç å™¨ã€‚

æ•°å­¦ä¸Šå¯ä»¥å†™æˆ$ğ‘§_ğ‘(ğ‘¥)=argmin_ğ‘–â€–ğ‘§_ğ‘’(ğ‘¥)âˆ’ğ‘’_ğ‘–â€–^2$ ï¼Œå…¶ä¸­ $ğ‘§_ğ‘’(ğ‘¥)$ æ˜¯åŸå§‹è¾“å…¥çš„ encoder å‘é‡ï¼Œæ¯”å¦‚ ğ‘– è¡¨ç¤ºç¬¬ ğ‘– ä¸ª codebook å‘é‡ï¼Œ$ğ‘§_ğ‘(ğ‘¥)$ è¡¨ç¤ºç”Ÿæˆçš„é‡åŒ–çŸ¢é‡ï¼Œä½œä¸ºè¾“å…¥ä¼ é€’ç»™è§£ç å™¨ã€‚

è¿™ä¸ª argminargmin æ“ä½œæœ‰ç‚¹ä»¤äººæ‹…å¿§ï¼Œå› ä¸ºå®ƒç›¸å¯¹äºç¼–ç å™¨æ˜¯ä¸å¯å¾®åˆ†çš„ã€‚ä½†åœ¨å®è·µä¸­ï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼å°† decoder çš„æ¢¯åº¦ç›´æ¥ä¼ é€’ç»™ encoder ï¼ˆencoder å’Œ codebook å‘é‡çš„æ¢¯åº¦è®¾ç½®ä¸º1ï¼Œå…¶ä»– codebook å‘é‡æ¢¯åº¦è®¾ç½®ä¸º0ï¼‰ã€‚

ç„¶åï¼Œè§£ç å™¨çš„ä»»åŠ¡æ˜¯é‡æ„æ¥è‡ªè¯¥é‡åŒ–çŸ¢é‡çš„è¾“å…¥ï¼Œå°±åƒåœ¨æ ‡å‡†è‡ªç¼–ç å™¨å…¬å¼ä¸­é‚£æ ·ã€‚

![img](https://sunlin-ai.github.io/images/image-20220602112701542.png)



### æ¨¡å‹ä»‹ç»



MoMask: ç”Ÿæˆå¼é®è”½å»ºæ¨¡ 3D äººä½“åŠ¨ä½œ

https://arxiv.org/pdf/2312.00063

https://ericguo5513.github.io/momask/



**MoMask æ¨¡å‹ä»‹ç»**

![å›¾ç‰‡](https://image.jiqizhixin.com/uploads/editor/fe345c7d-2e28-4d5f-9de5-e2e0505c577b/640.png)

â€‹                *å›¾ 2ï¼šMoMask æ¡†æ¶ç»“æ„ä¸è®­ç»ƒæµç¨‹*

*
*

MoMask æ¡†æ¶ä¸»è¦åŒ…å«ä¸‰ä¸ªå…³é”®çš„ç¥ç»ç½‘ç»œæ¨¡å—ï¼š



- **æ®‹å·®é‡åŒ–æ¨¡å‹ (Residual VQ-VAE)**ï¼Œå°†äººä½“åŠ¨ä½œè½¬æ¢ä¸ºå¤šå±‚ç¦»æ•£çš„åŠ¨ä½œæ ‡è®°ï¼ˆTokenï¼‰ã€‚åŸºå±‚ï¼ˆå³ç¬¬ä¸€å±‚ï¼‰çš„åŠ¨ä½œæ ‡è®°åŒ…å«äº†åŠ¨ä½œçš„åŸºæœ¬ä¿¡æ¯ï¼Œè€Œæ®‹å·®å±‚åˆ™å¯¹åº”æ›´ç»†ç²’åº¦çš„åŠ¨ä½œä¿¡æ¯ã€‚
- **Masked Transformer**ï¼šå¯¹åŸºå±‚çš„åŠ¨ä½œæ ‡è®°è¿›è¡Œå»ºæ¨¡ï¼Œé‡‡ç”¨éšæœºæ¯”ä¾‹çš„éšæœºæ©ç ï¼Œå¹¶æ ¹æ®æ–‡æœ¬ä¿¡æ¯é¢„æµ‹è¢«æ©ç çš„åŠ¨ä½œæ ‡è®°ï¼Œç”¨äºç”ŸæˆåŸºå±‚åŠ¨ä½œæ ‡è®°ã€‚
- **Residual Transformer**ï¼šå¯¹æ®‹å·®å±‚çš„åŠ¨ä½œæ ‡è®°è¿›è¡Œå»ºæ¨¡ï¼Œæ ¹æ®å‰ j å±‚çš„åŠ¨ä½œæ ‡è®°é¢„æµ‹ç¬¬ j å±‚çš„åŠ¨ä½œæ ‡è®°ï¼Œä»¥æ­¤æ¥å»ºæ¨¡æ®‹å·®å±‚çš„åŠ¨ä½œåºåˆ—ã€‚

![å›¾ç‰‡](https://image.jiqizhixin.com/uploads/editor/9abbb7d9-a5eb-43b4-8625-b9542e36d0e2/640.png)

â€‹               *å›¾ 3: T2M-GPT çš„åŠ¨ä½œç¦»æ•£åŒ–æ¨¡å‹ (VQ-VAE)*



**åŠ¨ä½œåºåˆ—ç¦»æ•£åŒ–ã€‚**MoMask é‡‡ç”¨åŸºäºç¦»æ•£è¡¨è¾¾çš„ç”Ÿæˆå¼æ¡†æ¶ï¼Œé¦–å…ˆå°†è¿ç»­çš„åŠ¨ä½œè¡¨è¾¾è¿›è¡Œç¦»æ•£åŒ–ã€‚å¦‚å›¾ 3ï¼Œä¼ ç»Ÿçš„ VQ-VAE åœ¨é‡åŒ–ï¼ˆQuantizationï¼‰è¿‡ç¨‹ä¸­å­˜åœ¨ä¿¡æ¯æŸå¤±é—®é¢˜ï¼Œå› ä¸ºå®ƒå°†æ¯ä¸ªéšå‘é‡æ›¿æ¢ä¸ºç ä¹¦ï¼ˆCodebookï¼‰ä¸­æœ€ç›¸è¿‘çš„ç å‘é‡ï¼Œè¿™ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å·®å¼‚å¯¼è‡´äº†ä¿¡æ¯çš„ä¸¢å¤±ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMoMask é‡‡ç”¨äº†å¤šå±‚é‡åŒ–çš„æ–¹æ³•ï¼ˆå›¾ 2.aï¼‰ï¼Œé€å±‚å¯¹éšå‘é‡å’Œç å‘é‡ä¹‹é—´çš„æ®‹å·®è¿›ä¸€æ­¥é‡åŒ–ï¼Œä»è€Œæé«˜äº†éšå‘é‡çš„ä¼°è®¡ç²¾åº¦ã€‚éšç€å±‚æ•°åŠ æ·±ï¼Œæ¯ä¸€å±‚æ‰€å»ºæ¨¡çš„ä¿¡æ¯é‡ï¼ˆå³æ®‹å·®ï¼‰ä¹Ÿé€æ­¥å‡å°‘ã€‚è®­ç»ƒæ—¶ï¼Œä¸ºäº†å°½å¯èƒ½å¢åŠ æ¯ä¸€ä¸ªé‡åŒ–å±‚çš„å®¹é‡ï¼Œæˆ‘ä»¬éšæœºä¸¢å¼ƒæ‰æœ«å°¾çš„è‹¥å¹²ä¸ªæ®‹å·®å±‚ã€‚æœ€ç»ˆï¼ŒåŠ¨ä½œåºåˆ—è¢«è½¬åŒ–ä¸ºå¤šå±‚çš„ç¦»æ•£åŠ¨ä½œæ ‡è®°ï¼Œå…¶ä¸­åŸºå±‚æ ‡è®°åŒ…å«äº†åŠ¨ä½œçš„ä¸»è¦å†…å®¹ï¼Œè€Œæ®‹å·®å±‚åˆ™ç”¨äºå¡«è¡¥åŠ¨ä½œçš„ç»†èŠ‚ã€‚æ¥ä¸‹æ¥ï¼ŒMoMask ä½¿ç”¨ Masked Transformer ç”ŸæˆåŸºå±‚åŠ¨ä½œæ ‡è®°ï¼Œå¹¶ä½¿ç”¨ Residual Transformer é€å±‚é¢„æµ‹æ®‹å·®å±‚çš„åŠ¨ä½œæ ‡è®°ã€‚



**ç”Ÿæˆå¼æ©ç å»ºæ¨¡ã€‚**å¦‚å›¾ 2.bï¼Œæ–‡æœ¬æè¿°é¦–å…ˆé€šè¿‡ CLIP ç¼–ç æˆè¯­ä¹‰å‘é‡ï¼ŒåŒæ—¶åŸºå±‚çš„åŠ¨ä½œæ ‡è®°åºåˆ—è¢«éšæœºæ©ç ã€‚ç„¶åï¼Œè¿™äº›æ©ç çš„åŠ¨ä½œæ ‡è®°åºåˆ—å’Œ CLIP æ–‡æœ¬å‘é‡ä¸€èµ·è¾“å…¥åˆ° Transformer ä¸­è¿›è¡Œè®­ç»ƒï¼Œå…¶ç›®æ ‡æ˜¯å‡†ç¡®é¢„æµ‹è¢«æ©ç æ‰çš„åŠ¨ä½œæ ‡è®°ã€‚ä¸ä»¥å¾€åŸºäºæ©ç çš„é¢„è®­ç»ƒæ¨¡å‹ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œæ©ç æ ‡è®°çš„æ¯”ä¾‹æ˜¯éšæœºçš„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ 0 åˆ° 1 çš„åŒºé—´å–å€¼ï¼Œè¿™æ„å‘³ç€æ©ç çš„ç¨‹åº¦ä¹Ÿæ˜¯éšæœºçš„ã€‚æœ€åæƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ ‡è®°éƒ½è¢«æ©ç ï¼Œè€Œæœ€å¥½æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ ‡è®°éƒ½è¢«ä¿ç•™ã€‚



**æ®‹å·®å±‚æ ‡è®°é¢„æµ‹ã€‚**ç”±äºæ®‹å·®å±‚åŒ…å«äº†æ›´ç»†ç²’åº¦çš„åŠ¨ä½œä¿¡æ¯ï¼Œå› æ­¤æ ¹æ®å‰é¢ j > 1 å±‚çš„åŠ¨ä½œæ ‡è®°å†…å®¹ï¼Œå¯ä»¥åŸºæœ¬ç¡®å®šç¬¬ j å±‚çš„åŠ¨ä½œæ ‡è®°ã€‚åœ¨è®­ç»ƒæ—¶ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªæ®‹å·®å±‚ j è¿›è¡Œé¢„æµ‹ï¼Œå°†å·²çŸ¥çš„å‰ j å±‚çš„åŠ¨ä½œæ ‡è®°ã€CLIP æ–‡æœ¬å‘é‡ä»¥åŠç¬¬ j å±‚çš„ç¼–ç è¾“å…¥åˆ° Transformer ä¸­ï¼Œä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°æ¥ä¼˜åŒ–æ¨¡å‹ã€‚

![å›¾ç‰‡](https://image.jiqizhixin.com/uploads/editor/ed7e3e44-900d-4042-90d6-22b14e2979cd/640.png)

â€‹                *å›¾ 4: MoMask æ¨æ–­æµç¨‹*

*
*

**ç”Ÿæˆè¿‡ç¨‹ã€‚**å›¾ 4 æè¿°äº† MoMask æ¡†æ¶ä¸­çš„ç”Ÿæˆè¿‡ç¨‹ã€‚ä»åŸºå±‚çš„åŠ¨ä½œæ ‡è®°åºåˆ—å¼€å§‹ï¼Œæ‰€æœ‰çš„åŠ¨ä½œæ ‡è®°éƒ½è¢«æ©ç ï¼Œç„¶åé€šè¿‡ Masked Transformer è¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°å®Œæ•´çš„æ ‡è®°åºåˆ—ã€‚æ¥ç€ï¼Œä»…ç½®ä¿¡åº¦æœ€é«˜çš„ä¸€éƒ¨åˆ†æ ‡è®°è¢«ä¿ç•™ï¼Œå‰©ä¸‹çš„æ ‡è®°å°†è¢«é‡æ–°æ©ç ï¼ˆRemaskï¼‰ï¼Œå¹¶é‡æ–°é¢„æµ‹ã€‚é€šè¿‡ä¸€ä¸ªé¢„è®¾çš„è°ƒåº¦å‡½æ•° (Schedule function)ï¼Œåœ¨ç»è¿‡ä¸€å®šæ¬¡æ•°çš„æ©ç ä¸é¢„æµ‹åï¼Œå¾—åˆ°æœ€ç»ˆçš„åŸºå±‚åŠ¨ä½œæ ‡è®°åºåˆ—ã€‚ç„¶åï¼ŒResidual Transformer æ ¹æ®åŸºå±‚çš„æ ‡è®°åºåˆ—ï¼Œé€å±‚åœ°é¢„æµ‹æ®‹å·®å±‚çš„æ ‡è®°åºåˆ—ã€‚æœ€ç»ˆï¼Œæ‰€æœ‰æ ‡è®°åºåˆ—è¢«è¾“å…¥åˆ° RVQ-VAE çš„è§£ç å™¨ä¸­ï¼Œå¹¶è§£ç è·å¾—å¯¹åº”çš„åŠ¨ä½œåºåˆ—ã€‚å› æ­¤ï¼Œæ— è®ºåŠ¨ä½œåºåˆ—çš„é•¿åº¦ä¸ºå¤šå°‘ï¼ŒMoMask åªéœ€è¦å›ºå®šæ­¥æ•°å»ç”Ÿæˆè¯¥åºåˆ—ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒMoMask ä»…éœ€è¦è¿›è¡Œä¸è¶…è¿‡ 20 æ­¥çš„è¿­ä»£ï¼ŒåŒ…æ‹¬åŸºç¡€ä¸æ®‹å·®å±‚çš„ç”Ÿæˆã€‚



**å®éªŒç»“æœ**[![img](https://image.jiqizhixin.com/uploads/editor/861adae8-a683-4cc4-a290-6103363a85f5/1714371928438.png)](https://mp.weixin.qq.com/s/uu-5XJRnS5QCpED-bljKfw)

â€‹             *è§†é¢‘ 2ï¼šMoMask ä¸åŸºçº¿æ–¹æ³•çš„å¯¹æ¯”*

*
*

åœ¨è§†é¢‘ 2 ä¸­ï¼ŒMoMask ä¸å…¶ä»–ä¸‰ä¸ªåŸºçº¿æ–¹æ³•è¿›è¡Œäº†å¯¹æ¯”ï¼ŒåŒ…æ‹¬ä¸»æµçš„æ‰©æ•£æ¨¡å‹ï¼ˆMDMã€MLDï¼‰å’Œ GPT æ¨¡å‹ï¼ˆT2M-GPTï¼‰ã€‚MoMask åœ¨åº”å¯¹æŒ‘æˆ˜æ€§åŠ¨ä½œï¼ˆå¦‚ç»Šè„šå’ŒæŠ±è„šï¼‰ä»¥åŠæ›´ç²¾ç»†çš„æ–‡æœ¬æ§åˆ¶æ–¹é¢è¡¨ç°æ›´å‡ºè‰²ã€‚



åœ¨ä¸‹è¡¨ä¸­ï¼Œæˆ‘ä»¬å¯¹ MoMask åœ¨ HumanML3D å’Œ KIT-ML æ•°æ®é›†ä¸Šçš„æ€§èƒ½è¿›è¡Œäº†æ›´å…¨é¢çš„åˆ†æã€‚å¯ä»¥çœ‹å‡ºï¼ŒMoMask æ¡†æ¶åœ¨ R-Precision å’Œ FID ç­‰æŒ‡æ ‡ä¸Šå§‹ç»ˆè¡¨ç°æœ€ä¼˜ï¼Œåœ¨ HumanML3D æ•°æ®é›†ä¸Šï¼Œç”Ÿæˆè´¨é‡è¾¾åˆ°äº† FID ä¸º 0.045ã€‚

![å›¾ç‰‡](https://image.jiqizhixin.com/uploads/editor/a50bea1a-2d38-480a-9929-cccbf8a3ac1c/640.png)

å›¾ 5 å±•ç¤ºäº† Masked Transformer æ¨æ–­æ­¥æ•°å¯¹ç”ŸæˆåŠ¨ä½œçš„æ•´ä½“è´¨é‡å½±å“ï¼Œå…¶ä¸­ FID å’Œ MM-Dist åˆ†åˆ«æŒ‡ç¤ºäº†åŠ¨ä½œç”Ÿæˆè´¨é‡ä»¥åŠåŠ¨ä½œä¸æ–‡æœ¬å†…å®¹çš„åŒ¹é…ç¨‹åº¦ï¼Œå€¼è¶Šä½ä»£è¡¨æ€§èƒ½è¶Šå¥½ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œä»…éœ€è¦è¿›è¡Œ 10 æ­¥æ¨æ–­ï¼Œç”Ÿæˆè´¨é‡å°±å¯ä»¥æ”¶æ•›åˆ°æœ€ä¼˜æ°´å¹³ã€‚

![å›¾ç‰‡](https://image.jiqizhixin.com/uploads/editor/6c9df7ea-efde-4de7-ae38-28aebf8293fe/640.png)

â€‹               *å›¾ 5: æ¨æ–­æ­¥æ•°å¯¹ç”Ÿæˆè´¨é‡å½±å“*

*
*

**åº”ç”¨ï¼šåŠ¨ä½œæ—¶åºè¡¥é½**



MoMask è¿˜å¯ç”¨äºåŠ¨ä½œåºåˆ—çš„æ—¶åºè¡¥é½ï¼Œå³æ ¹æ®æ–‡æœ¬å¯¹åŠ¨ä½œåºåˆ—æŒ‡å®šçš„åŒºé—´è¿›è¡Œç¼–è¾‘æˆ–ä¿®æ”¹ã€‚åœ¨è§†é¢‘ 3 ä¸­ï¼Œå±•ç¤ºäº†åŸºäº MoMask å¯¹åŠ¨ä½œåºåˆ—çš„å‰ç¼€ã€ä¸­é—´éƒ¨åˆ†å’Œåç¼€ï¼Œæ ¹æ®ç»™å®šçš„æ–‡æœ¬è¿›è¡Œå†…å®¹è¡¥é½ã€‚[![img](https://image.jiqizhixin.com/uploads/editor/70157ac6-ca40-4431-8e9b-f000ccab5122/1714371960335.png)](https://mp.weixin.qq.com/s/uu-5XJRnS5QCpED-bljKfw)              *è§†é¢‘ 3: åŸºäº MoMask çš„åŠ¨ä½œæ—¶åºè¡¥é½* 



###  è·‘ä»£ç 



#### æŠ¥é”™ä¸æ›´æ”¹è®°å½•

##### 1

###### é—®é¢˜

###### è§£é‡Š

###### è§£å†³

##### 1

###### é—®é¢˜

colab æŠ¥é”™ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts. bigframes 1.11.1 requires matplotlib>=3.7.1, but you have matplotlib 3.3.4 which is incompatible. mizani 0.9.3 requires matplotlib>=3.5.0, but you have matplotlib 3.3.4 which is incompatible. plotnine 0.12.4 requires matplotlib>=3.6.0, but you have matplotlib 3.3.4 which is incompatible. seaborn 0.13.1 requires matplotlib!=3.6.1,>=3.4, but you have matplotlib 3.3.4 which is incompatible

###### è§£é‡Š

è¿™ä¸ªæŠ¥é”™æ˜¯ç”±äºä½ çš„è½¯ä»¶åŒ…ä¹‹é—´å­˜åœ¨ä¾èµ–å†²çªå¯¼è‡´çš„ã€‚å…·ä½“æ¥è¯´ï¼Œä½ å®‰è£…çš„æŸäº›è½¯ä»¶åŒ…éœ€è¦ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ matplotlibï¼Œè€Œå½“å‰å·²å®‰è£…çš„ matplotlib ç‰ˆæœ¬ä¸å…¶è¦æ±‚çš„ç‰ˆæœ¬ä¸å…¼å®¹ã€‚

è¿™ç§æƒ…å†µå¯èƒ½ä¼šå‘ç”Ÿåœ¨ä½¿ç”¨ä¸åŒè½¯ä»¶åŒ…æ—¶ï¼Œå®ƒä»¬å„è‡ªæŒ‡å®šäº†å¯¹ç‰¹å®šè½¯ä»¶åŒ…çš„ç‰ˆæœ¬è¦æ±‚ï¼Œä½†è¿™äº›ç‰ˆæœ¬è¦æ±‚ä¹‹é—´å­˜åœ¨å†²çªã€‚è§£å†³è¿™ç§é—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯å°è¯•å‡çº§æˆ–é™çº§è½¯ä»¶åŒ…ä»¥æ»¡è¶³æ‰€æœ‰è½¯ä»¶åŒ…çš„éœ€æ±‚ã€‚

ä½ å¯ä»¥å°è¯•é€šè¿‡æ›´æ–°æˆ–é™çº§ matplotlib è½¯ä»¶åŒ…ï¼Œå¹¶ç¡®ä¿å…¶ä»–è½¯ä»¶åŒ…ä¹Ÿèƒ½æ»¡è¶³æ–°çš„ä¾èµ–å…³ç³»æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·ï¼Œå¦‚ conda æˆ– venvï¼Œæ¥éš”ç¦»ä¸åŒé¡¹ç›®çš„ä¾èµ–å…³ç³»ï¼Œé¿å…å‡ºç°å†²çªã€‚

###### è§£å†³

**!pip install matplotlib==3.7.1**



##### 2

###### é—®é¢˜

AttributeError: module 'numpy' has no attribute 'float'. `np.float` was a deprecated alias for the builtin `float`. To avoid this error in existing code, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here. The aliases was originally deprecated in NumPy 1.20; for more details and guidance see the original release note at:

###### è§£é‡Š

è¿™ä¸ªæŠ¥é”™æ˜¯å› ä¸ºåœ¨è¾ƒæ–°ç‰ˆæœ¬çš„ NumPy ä¸­ï¼Œ`np.float` è¿™ä¸ªåˆ«åå·²ç»è¢«å¼ƒç”¨ï¼Œå¹¶ä¸”ä¸å†å¯ç”¨ã€‚ç›¸åï¼Œä½ åº”è¯¥ç›´æ¥ä½¿ç”¨å†…ç½®çš„ `float` ç±»å‹æ¥è¡¨ç¤ºæµ®ç‚¹æ•°ã€‚é€šè¿‡ä½¿ç”¨ `float` ç±»å‹è€Œä¸æ˜¯ `np.float`ï¼Œå¯ä»¥é¿å…è¿™ä¸ªé”™è¯¯ã€‚

å¦‚æœä½ ç¡®å®æƒ³è¦ä½¿ç”¨ NumPy æä¾›çš„ç‰¹å®šæµ®ç‚¹æ•°ç±»å‹ï¼Œé‚£ä¹ˆå»ºè®®ä½¿ç”¨ `np.float64` æ¥ä»£æ›¿ `np.float`ã€‚è¿™æ ·å¯ä»¥æ˜ç¡®åœ°æŒ‡å®šæ‰€éœ€çš„ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†æŠ¥é”™ã€‚

æ€»ä¹‹ï¼Œé’ˆå¯¹è¿™ä¸ªæŠ¥é”™ï¼Œä½ åªéœ€è¦å°†ä»£ç ä¸­æ‰€æœ‰çš„ `np.float` æ›¿æ¢ä¸º `float` å³å¯ã€‚è¿™ç§ä¿®æ”¹ä¸ä¼šæ”¹å˜ä»»ä½•è¡Œä¸ºï¼Œä¹Ÿæ˜¯å®‰å…¨çš„ã€‚è¿™ä¸ªåˆ«åæœ€åˆæ˜¯åœ¨ NumPy 1.20 ç‰ˆæœ¬ä¸­è¢«å¼ƒç”¨çš„ï¼Œä½ å¯ä»¥å‚è€ƒç›¸åº”çš„å‘å¸ƒè¯´æ˜ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯å’ŒæŒ‡å¯¼ã€‚

###### è§£å†³

å°†æ‰€æœ‰çš„ `np.float` æ›¿æ¢ä¸º `float`



##### 3

###### é—®é¢˜

 ax.lines = [] AttributeError: can't set attribute 'lines'

###### è§£é‡Š

è¿™ä¸ªé”™è¯¯æ˜¯ç”±äºåœ¨è°ƒç”¨ `ax.lines = []` æ—¶å‘ç”Ÿçš„ã€‚æ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œ`lines` å±æ€§ä¸å…è®¸ç›´æ¥è®¾ç½®ä¸ºä¸€ä¸ªç©ºåˆ—è¡¨ã€‚

è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ `ax.clear()` æ–¹æ³•ä»£æ›¿ `ax.lines = []`ã€‚è¿™æ ·å¯ä»¥æ¸…é™¤æ‰€æœ‰ç»˜å›¾å…ƒç´ ï¼ŒåŒ…æ‹¬çº¿æ¡å’Œé›†åˆï¼Œä»è€Œè¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚

###### è§£å†³

**ax.clear()**   # ax.lines = []

   ax.clear() # ax.lines = []

â€‹    \# ax.collections = []





#### ç»“æœ

A person is running on a treadmill.

æ•ˆæœä¸é”™

![image-20240722111641254](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240722111641254.png)

![image-20240722111755531](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240722111755531.png)![image-20240722111802687](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240722111802687.png)



A person is vertically suspended in mid-air with their feet hovering.

æ‚¬æµ®åœ¨ç©ºä¸­çš„äººç‰©çš„åŠ¨ä½œï¼Œäººç‰©å‚ç›´ï¼Œä½†æ˜¯è„šæ˜¯æµ®ç©ºçš„å½¢æ€

å˜æˆç¿»è·Ÿæ–—äº†

![image-20240722112002708](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240722112002708.png)







æˆ‘è¦ç»™ä¸€ä¸ªåŠ¨ä½œç”Ÿæˆä¸€æ®µæç¤ºè¯ï¼Œè®©ä»–ç”Ÿæˆç±»ä¼¼æœ‰é­”æ³•çš„äººç‰©åœ¨ç©ºä¸­ä»åŸåœ°è…¾ç©ºçš„åŠ¨ä½œï¼Œæ‚¬æµ®åœ¨ç©ºä¸­çš„äººç‰©çš„åŠ¨ä½œï¼Œäººç‰©å‚ç›´ï¼Œä½†æ˜¯è„šæ˜¯æµ®ç©ºçš„å½¢æ€ï¼Œæ€ä¹ˆè¾“å…¥æç¤ºè¯­å¥ï¼Œç”¨è‹±æ–‡ã€‚ï¼šâ€œA person is â€

A person is magically levitating in mid-air, suspended vertically with feet gracefully floating.

float2.bvh

![image-20240722112248158](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240722112248158.png)





A person is magically levitating in mid-air, with both feet suspended and floating.

![image-20240722112523580](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240722112523580.png)

ä¼šå‡ºç°ä¸€ä¸ªäººç«™ä¸ç¨³çš„æƒ…å†µï¼Œè€Œä¸æ˜¯ä¸€ä¸ªäººé­”æ³•èˆ¬çš„è…¾ç©º



A person is gracefully soaring through the air, defying gravity as they float effortlessly above the ground.

ä¸€ä¸ªäººä¼˜é›…åœ°åœ¨ç©ºä¸­ç¿±ç¿”ï¼Œä¸é¡¾åœ°å¿ƒå¼•åŠ›ï¼Œæ¯«ä¸è´¹åŠ›åœ°æ¼‚æµ®åœ¨åœ°é¢ä¸Šã€‚

![image-20240722113302898](MoMask æ–‡æœ¬ä¸€é”®è½¬3Dæ•°å­—äººéª¨éª¼åŠ¨ç”».assets/image-20240722113302898.png)

A person is gracefully soaring through the air, defying gravity as they float effortlessly above the ground,

#### æ€è€ƒ

å¯èƒ½æ˜¯å…¶æ— æ³•ç†è§£æˆ–è€…æ€ä¹ˆå›äº‹ï¼Œç»™ä¸€ä¸ªè‰å›¾/ç±»ä¼¼éª¨æ¶çš„ä¸œè¥¿ï¼Œæˆ–è€…è§†é¢‘ç­‰è¾…åŠ©æ–‡æœ¬ï¼Œæ›´å¥½

èƒ½å¦èƒ½ç»“åˆsd

sdç»™å‡ºä¸€ä¸ªç¬¦åˆæè¿°çš„åŠ¨ä½œ/éª¨æ¶

ç„¶åäººä»¬æ ¹æ®è¿™ä¸ªéª¨æ¶å»åšåŠ¨ä½œçš„è°ƒæ•´ï¼Œç„¶åæœ€ç»ˆç”Ÿæˆè¿‘ä¼¼è¿™ä¸ªéª¨æ¶çš„åŠ¨ä½œ



a skeleton



#### ç”Ÿæˆé€Ÿåº¦

ä¸€èˆ¬æ˜¯20-40s
